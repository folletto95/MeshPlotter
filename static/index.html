<!doctype html>
<html lang="it"><head>
<meta charset="utf-8"/><title>Meshtastic Telemetry</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
<script>window.Chart || document.write('<script src="/static/chart.umd.min.js"><\\/script>')</script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3"></script>
<link rel="icon" type="image/svg+xml" href="/static/favicon.svg"/>
<style>
:root{
  --bd:#334155;
  --bg:#0f172a;
  --card-bg:#1e293b;
  --accent:#ff6d00;
  --text:#f8fafc;
}
body{
  font-family:system-ui,Segoe UI,Roboto,Ubuntu,sans-serif;
  margin:16px;
  background:var(--bg);
  color:var(--text);
}
header{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
  align-items:center;
  background:var(--card-bg);
  color:var(--text);
  padding:12px;
  border-radius:8px;
  box-shadow:0 1px 2px rgba(0,0,0,0.5);
}
select,button,input{
  padding:6px;
  border:1px solid var(--bd);
  border-radius:6px;
  background:var(--card-bg);
  color:var(--text);
}
button{
  background:var(--accent);
  color:#fff;
  border:none;
  cursor:pointer;
}
button:hover{background:#e05500}
a{color:var(--accent)}
select{min-width:260px}
.main{
  display:flex;
  gap:16px;
  margin-top:12px;
  align-items:stretch;
  height:calc(100vh - 120px);
}
.sidebar{
  min-width:260px;
  height:100%;
}
#nodes{
  width:100%;
  height:100%;
}
.toggles{
  margin-top:8px;
  display:flex;
  gap:12px;
  flex-wrap:wrap;
}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(480px,1fr));
  gap:16px;
  margin-top:12px;
}
.card{
  border:1px solid var(--bd);
  border-radius:12px;
  padding:12px;
  background:var(--card-bg);
  box-shadow:0 1px 3px rgba(0,0,0,0.5);
}
canvas{width:100%;height:400px}
small{color:#94a3b8}
</style>
</head>
<body>
<header>
  <h2 style="margin:0">Meshtastic Telemetry</h2>
  <label>
    <small>Intervallo</small><br/>
    <select id="range">
      <option value="3600">Ultima ora</option>
      <option value="21600">Ultime 6 ore</option>
      <option value="86400" selected>Ultime 24 ore</option>
      <option value="604800">Ultimi 7 giorni</option>
    </select>
  </label>
  <label>
    <small>Nickname</small><br/>
    <input id="nick" type="text"/>
  </label>
  <button id="save-nick">Salva Nickname</button>
  <button id="refresh">Aggiorna</button>
  <a href="/map">Mappa</a>
  <label><input type="checkbox" id="show-nick" checked/> Mostra nickname</label>
  <label style="margin-left:auto">
    <input type="checkbox" id="autoref" checked/> Auto-refresh (15s)
  </label>
</header>

<div class="main">
  <aside class="sidebar">
    <label>
      <small>Nodi (Long/Short/ID)</small><br/>
      <div id="nodes"></div>
    </label>
  </aside>
  <div class="content" style="flex:1">
    <div class="toggles">
      <label><input type="checkbox" id="toggle-temperature"/> °C</label>
      <label><input type="checkbox" id="toggle-humidity"/> %</label>
      <label><input type="checkbox" id="toggle-pressure"/> hPa</label>
      <label><input type="checkbox" id="toggle-voltage"/> V</label>
      <label><input type="checkbox" id="toggle-current"/> mA</label>
    </div>

    <div class="grid">
      <div class="card" id="card-temp"><h3 style="margin:0 0 8px">°C</h3><canvas id="chart-temp"></canvas></div>
      <div class="card" id="card-hum"><h3 style="margin:0 0 8px">%</h3><canvas id="chart-hum"></canvas></div>
      <div class="card" id="card-press"><h3 style="margin:0 0 8px">hPa</h3><canvas id="chart-press"></canvas></div>
      <div class="card" id="card-volt"><h3 style="margin:0 0 8px">V</h3><canvas id="chart-volt"></canvas></div>
      <div class="card" id="card-curr"><h3 style="margin:0 0 8px">mA</h3><canvas id="chart-curr"></canvas></div>
    </div>
  </div>
</div>

<script src="/static/app.js"></script>
</body></html>
